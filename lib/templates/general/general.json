{
    "name": "TH-E Control",
    "category": "TH-E Box",
    "group": "General",
    "description": "The control configurations of TH-E Box",
    
    "devices": [
        {
            "name": "TH-E-Control",
            "driver": "virtual"
        }
    ],
    
    "items": [
        {
            "id": "service",
            "type": "Switch",
            "label": "Enable",
            "default": true,
            "mapping": {
                "ON": { "channel": "control_enable", "value": true },
                "OFF": { "channel": "control_enable", "value": false }
            },
            "input": "control_enable"
        }
    ],

    "channels": [
        {
            "name": "control_enable",
            "description": "control_enable",
            "node": "Virtual",
            "device": "TH-E-Control",
            "logging": { "loggingInterval": 5000, "loggingMaxInterval": 60000 },
            "configs": { "valueType":"BOOLEAN" }
        },
        {
            "name": "grid_service_power",
            "description": "grid_service_power",
            "node": "Virtual",
            "device": "TH-E-Control",
            "logging": { "loggingInterval": 60000, "loggingMaxInterval": 900000 },
            "configs": { "valueType":"DOUBLE" },
            "processList": [
                {
                    "process": "log_to_feed",
                    "arguments": {"type": "ProcessArg::FEEDID", "value": "grid_service_power"}
                },
                {
                    "process": "allowpositive",
                    "arguments": {"type": "ProcessArg::NONE"}
                },
                {
                    "process": "log_to_feed",
                    "arguments": {"type": "ProcessArg::FEEDID", "value": "grid_service_import_power"}
                },
                {
                    "process": "power_to_kwh",
                    "arguments": {"type": "ProcessArg::FEEDID", "value": "grid_service_import_energy"}
                },
                {
                    "process": "reset2original",
                    "arguments": {"type": "ProcessArg::NONE"}
                },
                {
                    "process": "allownegative",
                    "arguments": {"type": "ProcessArg::NONE"}
                },
                {
                    "process": "scale",
                    "arguments": {"type": "ProcessArg::VALUE", "value": "-1"}
                },
                {
                    "process": "log_to_feed",
                    "arguments": {"type": "ProcessArg::FEEDID", "value": "grid_service_export_power"}
                },
                {
                    "process": "power_to_kwh",
                    "arguments": {"type": "ProcessArg::FEEDID", "value": "grid_service_export_energy"}
                }
            ]
        }
    ],

    "feeds": [
        {
            "name": "grid_service_power",
            "tag": "Power",
            "type": "DataType::REALTIME",
            "engine": "Engine::PHPTIMESERIES"
        },
        {
            "name": "grid_service_import_power",
            "tag": "Power",
            "type": "DataType::REALTIME",
            "engine": "Engine::PHPTIMESERIES"
        },
        {
            "name": "grid_service_import_energy",
            "tag": "Energy",
            "type": "DataType::REALTIME",
            "engine": "Engine::PHPTIMESERIES"
        },
        {
            "name": "grid_service_export_power",
            "tag": "Power",
            "type": "DataType::REALTIME",
            "engine": "Engine::PHPTIMESERIES"
        },
        {
            "name": "grid_service_export_energy",
            "tag": "Energy",
            "type": "DataType::REALTIME",
            "engine": "Engine::PHPTIMESERIES"
        }
    ]
}
